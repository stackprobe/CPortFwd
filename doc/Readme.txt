===============================================================================

　秘密鍵方式の暗号ポート転送プログラム

===============================================================================


■ソフトの概要

　ＴＣＰポートフォワーディングを行うプログラムです。
　通信データをそのまま送受信するか、暗号化・復号して送受信するか選択できます。
　暗号ポートフォワーディングと言えばＳＳＨですが、ＳＳＨがハイブリッド暗号方式であるのに対し、
　本プログラムは古典的な秘密鍵方式（共通鍵方式）を使用しています。


■動作環境

　Windows 10
　確認していませんが Windows 7/8/8.1 でも動くかもしれません。

　.NET Framework 4 を使用します。(コマンドライン版では不要)


■インストール方法

　アーカイブの中身をローカルディスク上の任意の場所にコピーして下さい。


■アンインストール方法

　レジストリなどは一切使っていません。
　ファイルを削除するだけでアンインストールできます。


■起動方法

　WCPortFwd.exe を実行して下さい。


■使い方

　起動するとすぐに最小化します。
　最小化時はタスクトレイに移動します。

　●タスクトレイ時の右クリックメニュー

　　開く ... ウィンドウを表示します。
　　終了 ... プログラムを終了します。


　●ウィンドウのボタン

　　開始 / 停止 ... 選択されているポートフォワードを停止している場合は開始、開始している場合は停止します。
　　追加        ... ポートフォワードを追加します。
　　削除        ... 選択されているポートフォワードを削除します。
　　変更        ... 選択されているポートフォワードを変更します。
　　▲          ... 選択されているポートフォワードを一つ上に移動します。
　　▼          ... 選択されているポートフォワードを一つ下に移動します。


　●転送設定の項目

　　待ち受けポート ... ローカルＰＣ上でＴＣＰ接続を待ち受けるポート番号を指定します。指定できる値は 1〜65535 です。
　　                   他のポート番号や、他プロセスが使用しているポート番号と重複させることはできません。
　　転送先ポート   ... 転送先のポート番号を指定します。指定できる値は 1〜65535 です。
　　転送先ホスト名 ... 転送先のホスト名またはＩＰアドレスを指定します。使用できる文字は英数字とピリオド・ハイフンです。
　　最大接続数     ... この待ち受けポートに同時に接続できる最大値を指定します。指定できる値は 1〜500 です。
　　                   １つの接続につきそれなりにリソースを消費するので、必要以上に大きな値にしないよう気を付けて下さい。
　　暗号化モード   ... 転送先への送信データを暗号化し、転送先からの受信データを復号します。
　　復号モード     ... 転送先への送信データを復号し、転送先からの受信データを暗号化します。
　　暗号化なし     ... 通信データをそのまま送受信します。
　　鍵生成         ... 鍵を自動生成します。
	クリア         ... 鍵またはパスフレーズをクリアします。
	Export         ... 鍵またはパスフレーズを鍵ファイルに保存します。
　　Import         ... 鍵またはパスフレーズを鍵ファイルから読み込みます。

　　鍵またはパスフレーズ ...

　　　暗号化・復号に使用する秘密鍵を指定します。
　　　本プログラムが使用する鍵の長さは 512 ビットです。
　　　128桁の16進数、つまり 0〜9, a〜f, A〜F の文字だけで構成された長さ128の文字列である場合、
　　　そのまま鍵として使用します。（このとき下に hex 512-bit と表示されます）
　　　それ以外の場合、文字列を Shift_JIS に変換したバイト列の SHA-512 を鍵として使用します。
　　　使用できる文字は半角英数字と一部の記号、空白以外の全角文字です。

　　リセット       ... 変更を破棄して、転送設定を開いた時の状態に戻します。


■コマンドラインから使用する場合

　●起動方法

　　CPortFwd.exe [/P recv-port-no] [/FP fwrd-port-no] [/FD fwrd-domain] [/C connect-max] [/K raw-key] [/D] [/S] [/Q]

　　　recv-port-no ... 待ち受けポート番号, 値域 = 1 〜 65535, 省略時 = 8080
　　　fwrd-port-no ... 転送先のポート番号, 値域 = 1 〜 65535, 省略時 = 80
　　　fwrd-domain  ... 転送先のホスト名またはＩＰアドレス, 省略時 = localhost
　　　connect-max  ... 最大接続数, 値域 = 1 〜 500, 省略時 = 10
　　　raw-key      ... 鍵またはパスフレーズ
　　　/D           ... 復号モード
　　　/S           ... サイレントモード
　　　/Q           ... エラーのときメッセージボックスを表示しません。

　　　/K を省略すると「暗号化なし」で動作します。このとき /D を指定しても無視します。
　　　/K を指定した場合 ... /D を省略すると「暗号化モード」指定すると「復号モード」で動作します。

　　　コマンドラインからはパスフレーズに CP932 のどのような文字列も指定できます。

　　実行例

　　　CPortFwd /P 5900 /FP 58946 /FD vnc-server /K "I$M@★ CINDERELLA GIRLS"

　　　CPortFwd /P 58946 /FP 5900 /K "I$M@★ CINDERELLA GIRLS" /D


　●停止方法

　　エスケープキーを押すか、以下のコマンドを実行して下さい。

　　　CPortFwd.exe [/P recv-port-no] /T

　　　実行例

　　　　CPortFwd /P 5900 /T

　　　　CPortFwd /P 58946 /T


■暗号の実装

　●データが破損または改ざんされたときの振る舞い

　　接続時 (不明なクライアントからの接続, パスフレーズの間違い, 通信データの破損・改ざん)

　　　... 直ちに切断する。復号モードの場合、転送先には一切接続しない。

　　通信時 (通信データの破損・改ざん)

　　　... 直ちに切断する。


■取り扱い種別

　フリーソフト


■作者への連絡先

　stackprobes@gmail.com

　バグや要望などご連絡ください。

